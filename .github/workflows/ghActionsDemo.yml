# File: .github/workflows/workflow.yml
name: GitHub Actions Demo
on: [push]
jobs:
  build-and-deploy:
    runs-on: windows-latest
    steps:
      - name: Check out repository code
        uses: actions/checkout@v2
      - name: Create test mg
        uses: azure/powershell@v1
        with:
          inlineScript: |
            Uninstall-AzureRm
          azPSVersion: '4.3.0'
      - name: Run Azure PowerShell login script
        uses: azure/powershell@v1
        with:
          inlineScript: |
            $azureAplicationId = "0a90645e-43f7-4228-a3bd-e71961edc59b"
            $azureTenantId= "8de3d3fb-4ae1-4c39-99e0-bede3ca0a96c"
            $azurePassword = ConvertTo-SecureString "uDTKOnZiHMcwpcMs45GfEFIr.xYQSMjlSJ" -AsPlainText -Force
            $psCred = New-Object System.Management.Automation.PSCredential($azureAplicationId , $azurePassword)
            Connect-AzAccount -Credential $psCred -TenantId $azureTenantId  -ServicePrincipal
          azPSVersion: '4.3.0'
      - name: Create test mg
        uses: azure/powershell@v1
        with:
          inlineScript: |
            New-AzManagementGroup -GroupName "TestMg03"
          azPSVersion: '4.3.0' 
